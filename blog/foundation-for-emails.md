# Основные правила при верстке писем

Для того, чтобы сверстанное HTML-письмо отображалось корректно в большинстве почтовых клиентов, необходимо соблюдать некоторые правила.

## Максимальная ширина контента

При использовании максимальной ширины в 600 пикселей пользователям нет небходимости прокручивать письмо горизонтально.
   
## Изображения 

* Изображения должны быть не более 200Кбайт. Картинку надо сжать перед вставкой в письмо. 
  Например, можно воспользоваться [сервисом](http://resizepiconline.com/) для сжатия изображений, либо использовать
  любую графическую программу для работы с растровыми изображениями.
* Почтовые клиенты обычно понимают следующие форматы изображений: `.jpg, .png, .jpeg, .gif`
* По умолчанию все почтовые клиенты прячут изображения, поэтому в атрибуте `alt` тега `img` желательно указывать наименование изображения.
   
   
## Использование безопасных веб-шрифтов

Существуют так называемые [безопасные веб-шрифты](http://www.wearymax.ru/webmasters/fonts/) - это те, которые будут отображаться большинством почтовых клиентов. Такие шрифты делятся на 4 семействаы: 
* serif (с засечками),
* sans serif (без засечек), 
* cursive (курсив)
* monospace (моноширный).

Каждое из этих семейств имеют основные шрифты и резервные.

### Шрифты с засечками 

Используются в основном в заголовках:

```
font-family: 'Bookman Old Style', serif;
font-family: 'Arial Black', Gadget, sans-serif;
font-family: Impact, Charcoal, sans-serif;
font-family: 'MS Sans Serif', Geneva, sans-serif;
font-family: 'MS Serif', 'New York', sans-serif;
font-family: 'Trebuchet MS', Helvetica, sans-serif;
font-family: Verdana, Geneva, sans-serif;
font-family: 'Lucida Sans Unicode', 'Lucida Grande', sans-serif;
font-family: Tahoma, Geneva, sans-serif;
```

### Моноширные шрифты

Используются в основном для создания таблиц:
  
```
font-family: Courier, monospace;
font-family: 'Courier New', Courier, monospace;
font-family: 'Lucida Console', Monaco, monospace;
```

### Шрифты без засечек 

Используются для основного содержимого страницы:
  
```
font-family: Arial, Helvetica, sans-serif;
font-family: 'Arial Black', Gadget, sans-serif;
font-family: Impact, Charcoal, sans-serif;
font-family: 'MS Sans Serif', Geneva, sans-serif;
font-family: 'MS Serif', 'New York', sans-serif;
font-family: 'Trebuchet MS', Helvetica, sans-serif;
font-family: 'Lucida Sans Unicode', 'Lucida Grande', sans-serif;
font-family: Tahoma, Geneva, sans-serif;
```

### Курсивные шрифты 

Используют в основном чтобы выделить текст:

```
font-family: 'Comic Sans MS', cursive;
```

## Размер письма

Идеальный размер email варьируется в пределах 15 Kбайт — 100 Kбайт. При превышение этого лимита письмо будет попадать в спам-фильтры.

## Структура письма. Ограничения.

Необходимо использовать простую структуру, так как есть много ограничений в html и css. Далеко не все почтовые клиенты понимают CSS3, поэтому нужно постараться не пользоваться его возможностами, либо делать плавную деградацию. Посмотреть какие свойства поддерживаются почтовыми клиентами можно в [этой таблице](https://www.campaignmonitor.com/css/) или, например, у Gmail-клиента есть [справка](https://developers.google.com/gmail/design/reference/supported_css).

## Inline CSS

Большинство почтовых клиентов игнорируют подключение внешних CSS-стилей. Некоторые игнорируют также стили которые подключены в теге `<style></style>`. Поэтому предпочтительнее использовать inline-стили, т.е. через аттрибут `style` у любого `html`-тега, например:

```html
<div style="color: red; background: black"></div>
```

Поскольку писать inline-стили неудобно, можно написать их в обычном стиле, а затем воспользоваться каким-нибудь [inline-препроцессором](https://www.npmjs.com/package/inline-css) или одним из онлайн-конвертеров (например [этим](https://templates.mailchimp.com/resources/inline-css/) или [этим](https://inliner.cm/)). В долгосрочной перспективе, если понадобится отредактировать email-письмо еще раз - удобно предварительно настроить фронтенд-сборщик (например gulp), в который подключить препроцессор для inline-конвертации CSS -- тогда можно будет менять исходный код, а сборщик будет его автоматически компилировать в готовое письмо. 


## Email-фреймворки

Для ускорения верстки корректных шаблонов email-писем (в т.ч. и адаптивных), существуют готовые фреймворки. Они удобны тем, что уже учитывают множество нюансов верстки под различные подчтовые клиенты. Вот пример двух популярных фреймворков:

* [Foundation for Emails](http://foundation.zurb.com/emails.html)
* [MJML](https://mjml.io/)

Также можно не использовать фреймворки, но подглядывать в их исходный код, для заимствования готовых решений в конкретных случаях.

## Тестирование писем

### Бесплатно, быстро, неточно

Для того, чтобы поверхностно просмотреть результат верстки письма, можно открыть его в веб-браузере. 

### Бесплатно, точно, долго

Самый верный, но долгий способ - это отправка письма, а потом просмотр его через различные почтовые клиенты (OSX Mail, MS Outlook, TheBat, Thunderbird...) и веб-клиенты (Gmail, Yandex, Yahoo..). Можно немного съэкономить время, воспользовавшись автоматической рассылкой. Такую автоматическую рассылку несложно сделать самому, если знаком какой-нибудь из бэкенд-языков программирования (Ruby, JavaScript, PHP, Python, C#, Java...). Также в интернете много готовых решений, например можно форкнуть [вот такой](https://github.com/AlexKalinin/send-email-with-ruby) проект, и уже на основе него попробовать сверстать [свой шаблон email-письма](https://github.com/NataliaVolik/email-template-table-layout)

### Платно, быстро, близко к точному
Можно воспользоваться одним из платных веб-сервисов для тестирования email под сразу множество почтовых клиентов. Вот примеры популярных:
 
* [Litmus](https://litmus.com/)
* [Email on Acid](https://www.emailonacid.com/email-testing)

Также эти сервисы (на момент написания статьи) предоставляют trial-режим, так что если Вам нужно сверстать всего одно-два письма, можно это сделать даже бесплатно. 
